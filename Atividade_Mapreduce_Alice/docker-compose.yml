version: '3.8'

services:
  atividade-mapreduce-alice:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: atividade-mapreduce-alice

    volumes:
      - ./inputs:/app/inputs
      - ./outputs:/app/outputs
      - ./atividade_mapreduce_alice:/app/atividade_mapreduce_alice
      - ./exercicio5:/app/exercicio5
      - ./requirements.txt:/app/requirements.txt


    environment:
      - DATASET_SIZE=1000
      - SPARK_MASTER=local[*]
      - PYTHONUNBUFFERED=1

    ports:
      - "4040:4040"

    mem_limit: 4g
    mem_reservation: 2g
    cpus: 2

    restart: "no"

    healthcheck:
      test: ["CMD", "python", "-c", "import pyspark"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
